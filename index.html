<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Pastel Envelopes — Mini Cash Pockets</title>
<style>
:root {
  --bg: #fffdfb;
  --card: #ffffff;
  --muted: #6b7280;
  --text: #1b1b1b;
  --shadow: 0 6px 18px rgba(16,24,40,0.06);

  /* Your palette */
  --col-1: #EDD9BE;
  --col-2: #FAC1B5;
  --col-3: #C59FBE;
  --col-4: #F283AE;
  --col-5: #98B8B9;
  --col-6: #C6C870;
}

body {
  font-family: 'Montserrat', sans-serif;
  background: linear-gradient(180deg, var(--bg) 0%, #fff 100%);
  color: var(--text);
  margin: 0;
  -webkit-font-smoothing: antialiased;
}

h1, .title {
  font-family: 'Playfair Display', serif;
  font-weight: 700;
  margin: 0;
  word-break: break-word;
}

.small, .muted, .btn, .amt, .envFooter {
  font-family: 'Montserrat', sans-serif;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.wrap {max-width:920px;margin:18px auto;padding:14px;display:grid;grid-template-columns:1fr;gap:12px}
.top {display:flex;justify-content:space-between;align-items:center;gap:12px}
.small {font-size:13px;color:var(--muted)}
.panel {background:var(--card);border-radius:14px;padding:12px;box-shadow:var(--shadow)}

.input {padding:8px;border-radius:10px;border:1px solid rgba(15,23,36,0.06);flex:1}
.btn {background:#1b1b1b;color:white;padding:8px 10px;border-radius:10px;border:none;font-weight:600;cursor:pointer}
.btn.ghost {background:transparent;color:var(--text);border:1px solid rgba(15,23,36,0.06)}

.grid {display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px}
.env {
  border-radius:12px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  align-items:start;
  min-height:160px; /* increased for text */
}
.env .amt {font-weight:800;font-size:16px}
.donutWrap{width:64px;height:64px;flex:0 0 64px}
.smallBtn{padding:6px 8px;border-radius:8px;border:0;background:transparent;cursor:pointer}
.muted{color:var(--muted);font-size:13px}
.amt-container{text-align:right;word-break:break-word;}

.bg-1 {background:linear-gradient(180deg,var(--col-1),#fff);}
.bg-2 {background:linear-gradient(180deg,var(--col-2),#fff);}
.bg-3 {background:linear-gradient(180deg,var(--col-3),#fff);}
.bg-4 {background:linear-gradient(180deg,var(--col-4),#fff);}
.bg-5 {background:linear-gradient(180deg,var(--col-5),#fff);}
.bg-6 {background:linear-gradient(180deg,var(--col-6),#fff);}
.bg-debt{background:linear-gradient(180deg,#fff3e6,#fff)}

footer{font-size:12px;color:var(--muted);text-align:center;margin-top:8px}
</style>
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#C59FBE">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
<div class="wrap">
  <div>
    <div class="top">
      <div>
        <h1>Pastel Envelopes</h1>
        <div class="small">Digital cash envelope system — local only</div>
      </div>
      <div class="small">Available: <strong id="available">$0.00</strong></div>
    </div>

    <div class="panel" style="margin-top:12px;">
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <input id="incomeInput" class="input" placeholder="Add income (e.g. 450)" type="number" />
        <button id="addIncome" class="btn">Add Income</button>
        <button id="exportBtn" class="btn ghost">Export</button>
        <input id="importFile" type="file" accept="application/json" style="display:none"/>
        <button id="importBtn" class="btn ghost">Import</button>
      </div>
      <div style="margin-top:10px" class="small muted">Tip: Add income, then allocate to envelopes by tapping an envelope and using Allocate.</div>
    </div>

    <div class="panel" style="margin-top:10px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div><strong>Envelopes</strong></div>
        <div class="small muted">Tap an envelope to open controls</div>
      </div>

      <div id="envelopeGrid" class="grid"></div>
    </div>

    <div class="panel" style="margin-top:10px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div><strong>Transactions</strong></div>
        <div class="small muted">Recent</div>
      </div>
      <div id="txnList" style="max-height:220px;overflow:auto"></div>
    </div>

    <footer>LocalStorage-only. Export JSON to backup. Add to Home Screen for quick access.</footer>
  </div>

  <div class="sidebar panel">
    <div id="details">
      <div id="selectedName" style="font-weight:800">Select an envelope</div>
      <div id="selectedTarget" class="muted" style="margin-bottom:8px">—</div>

      <div style="display:flex;gap:8px;margin-bottom:8px">
        <input id="allocAmt" class="input" type="number" placeholder="Allocate from Available" />
        <button id="allocBtn" class="btn">Allocate</button>
      </div>

      <div style="display:flex;gap:8px;margin-bottom:8px">
        <input id="expenseAmt" class="input" type="number" placeholder="Add expense (positive)" />
        <input id="expenseNote" class="input" type="text" placeholder="Note (e.g. groceries)" />
        <button id="expenseBtn" class="btn">Spend</button>
      </div>

      <div style="display:flex;gap:8px;margin-bottom:10px">
        <input id="transferTo" class="input" placeholder="Transfer to envelope name" />
        <input id="transferAmt" class="input" type="number" placeholder="Amount" style="width:90px"/>
        <button id="transferBtn" class="btn ghost">Transfer</button>
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button id="clearBtn" class="btn ghost">Clear Envelope</button>
        <button id="setTargetBtn" class="btn ghost">Set Target</button>
      </div>

      <div style="height:8px"></div>
      <div class="small muted">Quick tips:</div>
      <ul class="small muted">
        <li>Allocate income, then spend from envelopes.</li>
        <li>Export before major changes.</li>
        <li>Tap envelope colors to open.</li>
      </ul>
    </div>
  </div>
</div>

<script src="index.js"></script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js')
    .then(()=>console.log('sw registered'))
    .catch(e=>console.warn('sw failed', e));
}
</script>
</body>
</html>
